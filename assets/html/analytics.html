<!DOCTYPE html>
<html>
    <head>
        <title>Analytics Page</title>
        <link rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <link
            href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
            rel="stylesheet">
        <link
            href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap"
            rel="stylesheet">
        <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <style>
        body {
        font-family: 'Montserrat', sans-serif; 
        color: black;
        }

        h1 {
             /* Mengatur elemen menjadi flexbox untuk mengatur ikon dan teks */
            align-items: center; /* Menyelaraskan ikon dan teks secara vertikal */
            text-align: center; /* Menengahkan teks */
            font-family: 'Montserrat';
            font-weight: 700; /* Ketebalan font */
            color: black; /* Warna teks gelap */
            margin-bottom: 20px; 
        }

        h1 i {
        margin-right: 10px; /* Memberi jarak antara ikon dan teks */
        font-size: 1.2em; /* Memperbesar ukuran ikon */
        color: black;
        padding-bottom: 50px;
        }

        h5 {
        text-align: center;
        margin-bottom: 20px;
        font-weight: 600;
        }

        .card {
        border: none;
        box-shadow: 0 10px 20px rgba(15, 15, 15, 0.1);
        margin-bottom: 30px; 
        border-color: #9E7148;
        border-style: dashed;
        }

        .card-body {
        padding: 30px;
        }

        .chart-container {
        position: relative;
        height: 350px;
        }

        #weekdayWeekendChart {
        margin: 0 auto;
        }

        .logo-container {
        display: flex;
        justify-content: flex-end;
        padding: 10px;
        }

        .logo-wrapper {
        background-color: white;
        padding: 10px;
        border-radius: 10px; /* Menambahkan radius pada container */
        display: flex;
        align-items: center;
        }

        .logo {
        max-width: 80px; /* Sesuaikan ukuran logo sesuai kebutuhan */
        margin-left: 10px;
        }
    </style>
    </head>
    <body>
        <div class="logo-container">
            <div class="logo-wrapper">
                <img src="../img/astoria.jpg" alt="Astoria Logo" class="logo">
                <img src="../img/hellskitchen.jpg" alt="Hell's Kitchen Logo"
                    class="logo">
                <img src="../img/lowermanhattan.jpg" alt="Lower Manhattan Logo"
                    class="logo">
            </div>
        </div>

        <div class="container mt-5">
            <h1>
                <i class="fas fa-chart-line"></i> Analisis Penjualan
            </h1>

            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header" style="background-color: #f0f0f5;"></div>
                        <div class="card-body chart-container">
                            <h5 class="card-title">
                                <i class="fas fa-chart-line"></i> 
                                Tren Pendapatan Harian
                            </h5>
                            <canvas id="dailyRevenueChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header" style="background-color: #f0f0f5;"></div>
                        <div class="card-body chart-container">
                            <h5 class="card-title">
                                <i class="fas fa-chart-bar"></i> 
                                Distribusi Pendapatan Per Jam
                            </h5>
                            <canvas id="hourlyRevenueChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 offset-md-3">
                    <div class="card">
                        <div class="card-header" style="background-color: #f0f0f5;"></div>
                        <div class="card-body chart-container">
                            <h5 class="card-title">
                                <i class="fas fa-chart-pie"></i> 
                                Pendapatan Hari Kerja vs. Akhir Pekan
                            </h5>
                            <canvas id="weekdayWeekendChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card keterangan">
                <div class="card-header" style="background-color: #f0f0f5;">
                    <i class="fas fa-info-circle"></i> 
                    <strong>Keterangan</strong>
                </div>
                <div class="card-body" style="background-color: #f8f9fa;">
                    <ul>
                        <li>Data ini mencakup penjualan dari tanggal 2023-01-08 hingga 2023-06-29.</li>
                        <li>Grafik "Tren Pendapatan Harian" menunjukkan fluktuasi pendapatan harian.</li>
                        <li>Grafik "Distribusi Pendapatan Per Jam" menunjukkan jam-jam tersibuk untuk penjualan.</li>
                        <li>Grafik "Pendapatan Hari Kerja vs. Akhir Pekan" membandingkan pendapatan total antara hari kerja dan akhir pekan.</li>
                    </ul>
                    </ul>
                </div>
            </div>
            
        </div>

        <script>
        // Fetch data from data.json
        fetch('../json/data.json')
        .then(response => response.json())
        .then(data => {
            // Aggregate data
            const dailyRevenue = {};
            const hourlyRevenue = new Array(24).fill(0);
            let weekdayRevenue = 0;
            let weekendRevenue = 0;

            data.forEach(transaction => {
            const date = transaction.transaction_date;
            const hour = parseInt(transaction.Hour);
            const weekday = parseInt(transaction.Weekday);

            dailyRevenue[date] = (dailyRevenue[date] || 0) + parseFloat(transaction.Revenue);
            hourlyRevenue[hour] += parseFloat(transaction.Revenue);
            if (weekday < 6) { // Weekday (0-5)
                weekdayRevenue += parseFloat(transaction.Revenue);
            } else { // Weekend (6-7)
                weekendRevenue += parseFloat(transaction.Revenue);
            }
            });

            // Color palette
            const colors = ["#6F798C", "#966C4D", "#C58C58"];

            // Chart Font Style
            Chart.defaults.font.family = 'Montserrat';

            // Prepare data for Chart.js (with color changes)
            const dailyRevenueData = {
            labels: Object.keys(dailyRevenue),
            datasets: [{
                label: 'Daily Revenue',
                data: Object.values(dailyRevenue),
                borderColor: colors[0], // Use the first color from the palette
                fill: false
            }]
            };

            const hourlyRevenueData = {
            labels: Array.from({length: 24}, (_, i) => i),
            datasets: [{
                label: 'Hourly Revenue',
                data: hourlyRevenue,
                backgroundColor: colors[1] // Use the second color
            }]
            };

            const weekdayWeekendData = {
            labels: ['Weekday', 'Weekend'],
            datasets: [{
                data: [weekdayRevenue, weekendRevenue],
                backgroundColor: [colors[1], colors[2]] // Use second and third colors
            }]
            };

            // Create charts (with enhancements)
            new Chart(document.getElementById('dailyRevenueChart'), {
            type: 'line',
            data: dailyRevenueData,
            options: {
                scales: { 
                x: {
                    ticks: {
                    maxTicksLimit: 10,
                    autoSkip: true,
                    }
                }
                }
            }
            });

            new Chart(document.getElementById('hourlyRevenueChart'), {
            type: 'bar',
            data: hourlyRevenueData,
            options: {
                scales: {
                y: {
                    beginAtZero: true 
                }
                }
            }
            });

            new Chart(document.getElementById('weekdayWeekendChart'), {
            type: 'pie',
            data: weekdayWeekendData,
            options: {
                plugins: {
                legend: {
                    position: 'bottom',
                    labels: { font: { size: 14, weight: 'bold'}, color: '#555'}
                }
            }}
            });
        })
        .catch(error => {
            console.error('Error fetching or processing data:', error); 
        });
    </script>
    </body>
</html>
